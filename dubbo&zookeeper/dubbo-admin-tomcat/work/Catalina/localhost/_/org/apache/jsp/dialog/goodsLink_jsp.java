/*
 * Generated by the Jasper component of Apache Tomcat
 * Version: Apache Tomcat/7.0.28
 * Generated at: 2013-06-24 04:35:15 UTC
 * Note: The last modified time of this file was set to
 *       the last modified time of the source file after
 *       generation to assist with modification tracking.
 */
package org.apache.jsp.dialog;

import javax.servlet.*;
import javax.servlet.http.*;
import javax.servlet.jsp.*;
import java.util.*;

public final class goodsLink_jsp extends org.apache.jasper.runtime.HttpJspBase
    implements org.apache.jasper.runtime.JspSourceDependent {

  private static final javax.servlet.jsp.JspFactory _jspxFactory =
          javax.servlet.jsp.JspFactory.getDefaultFactory();

  private static java.util.Map<java.lang.String,java.lang.Long> _jspx_dependants;

  static {
    _jspx_dependants = new java.util.HashMap<java.lang.String,java.lang.Long>(2);
    _jspx_dependants.put("/WEB-INF/doqian.tld", Long.valueOf(1371708192250L));
    _jspx_dependants.put("/includes/page_inc.jsp", Long.valueOf(1371707401703L));
  }

  private javax.el.ExpressionFactory _el_expressionfactory;
  private org.apache.tomcat.InstanceManager _jsp_instancemanager;

  public java.util.Map<java.lang.String,java.lang.Long> getDependants() {
    return _jspx_dependants;
  }

  public void _jspInit() {
    _el_expressionfactory = _jspxFactory.getJspApplicationContext(getServletConfig().getServletContext()).getExpressionFactory();
    _jsp_instancemanager = org.apache.jasper.runtime.InstanceManagerFactory.getInstanceManager(getServletConfig());
  }

  public void _jspDestroy() {
  }

  public void _jspService(final javax.servlet.http.HttpServletRequest request, final javax.servlet.http.HttpServletResponse response)
        throws java.io.IOException, javax.servlet.ServletException {

    final javax.servlet.jsp.PageContext pageContext;
    javax.servlet.http.HttpSession session = null;
    final javax.servlet.ServletContext application;
    final javax.servlet.ServletConfig config;
    javax.servlet.jsp.JspWriter out = null;
    final java.lang.Object page = this;
    javax.servlet.jsp.JspWriter _jspx_out = null;
    javax.servlet.jsp.PageContext _jspx_page_context = null;


    try {
      response.setContentType("text/html;charset=UTF-8");
      pageContext = _jspxFactory.getPageContext(this, request, response,
      			null, true, 8192, true);
      _jspx_page_context = pageContext;
      application = pageContext.getServletContext();
      config = pageContext.getServletConfig();
      session = pageContext.getSession();
      out = pageContext.getOut();
      _jspx_out = out;

      out.write('\r');
      out.write('\n');
      out.write("\r\n");
      out.write("\r\n");
      out.write("\r\n");
      out.write(" \r\n");
      out.write("\r\n");
      out.write("\r\n");
      out.write("<form id=\"formGoodsLink\" action=\"?login\" method=\"post\">\r\n");
      out.write("\r\n");
      out.write("\r\n");
      out.write("<table>\r\n");
      out.write("\t<tr>\r\n");
      out.write("\t\t<td width=\"60px\" align=\"center\"><strong>关联名称</strong></td>\r\n");
      out.write("\t\t<td width=\"520px\"><input type=\"text\" name=\"relateName\" id=\"relateName\"/>&nbsp;&nbsp;例如“颜色”、“尺寸”、“型号”等</td>\r\n");
      out.write("\t</tr>\r\n");
      out.write("</table>\r\n");
      out.write("<br>\r\n");
      out.write("<div style=\"width: 100%;\">\r\n");
      out.write("\t\t<ul id=\"goodsTable\">\r\n");
      out.write("\t\t\t\t\r\n");
      out.write("\t\t\t\t\t\t\r\n");
      out.write("\t\t\t\t\t\r\n");
      out.write("\t\t</ul>\r\n");
      out.write("\t\t</div>\r\n");
      out.write("\r\n");
      out.write("</form>\r\n");
      out.write("<input type=\"hidden\" id=\"hiddenTitle\"/>\r\n");
      out.write("<!-- IE8 style 标签写在HTML片段下方才能生效 -->\r\n");
      out.write("<style>\r\n");
      out.write("#login-form p { padding:5px;  }\r\n");
      out.write("#login-form input { width:15em; padding:4px; border:1px solid #CCC; }\r\n");
      out.write("#login-form input:focus { border-color:#426DC9; }\r\n");
      out.write("#login-form .login-form-error { background:#FFFBFC; border-color:#F00 !important; }\r\n");
      out.write("</style>\r\n");
      out.write("<!--\r\n");
      out.write("\t1、 标准script的标签将会被执行，这里要注意此处定义的变量会污染全局\r\n");
      out.write("    2、 本页编码要与对话框所在页面编码保持一致\r\n");
      out.write("-->\r\n");
      out.write("<script type=\"text/javascript\">\r\n");
      out.write("\r\n");
      out.write("$(function(){\r\n");
      out.write("\t\r\n");
      out.write("\t$.ajax({ \r\n");
      out.write("\t    url:'/sysadm/mall/getGoodsByJson.do?goodsId=");
      out.write((java.lang.String) org.apache.jasper.runtime.PageContextImpl.proprietaryEvaluate("${param.goodsId}", java.lang.String.class, (javax.servlet.jsp.PageContext)_jspx_page_context, null, false));
      out.write("',\r\n");
      out.write("\t    dataType:'json',\r\n");
      out.write("\t    success:function(data){ \r\n");
      out.write("\t    \tvar size = data.length;\r\n");
      out.write("\t    \tfor(var i=0;i<size;i++){\r\n");
      out.write("\t    \t\tvar goodsItem = \"<li style='float:left;width:123px;border:1px solid #E7E7E7;'><table align='center'><tr><td align='center'><img src='\"+data[i].thumb+\"' width='100px' height='100px'/></td></tr><tr><td align='center'>标题<input type='text' name='relateTitle' value='\"+data[i].relateTitle+\"' style='width: 75px;'/></td></tr><tr><td align='center'>排序<input type='text' value='\"+(i*1+1)+\"' name='orderBy' style='width: 75px;'/></td></tr><tr><td align='center'><a href='javascript:deteleGoodsLink(\"+data[i].itemid+\")'>[移除]</a></td></tr><input type='hidden' value='\"+data[i].itemid+\"' name='id'/></table></li>\";\r\n");
      out.write("\t\t       $(\"#goodsTable\").append(goodsItem);\r\n");
      out.write("\t    \t}\r\n");
      out.write("\t    }, \r\n");
      out.write("\t    async : false,\r\n");
      out.write("\t\tcache : false\r\n");
      out.write("\t});\r\n");
      out.write("}) \r\n");
      out.write("$(function(){\r\n");
      out.write("\t$.ajax({ \r\n");
      out.write("\t    url:'/sysadm/mall/getGoodsById.do?goodsId=");
      out.write((java.lang.String) org.apache.jasper.runtime.PageContextImpl.proprietaryEvaluate("${param.goodsId}", java.lang.String.class, (javax.servlet.jsp.PageContext)_jspx_page_context, null, false));
      out.write("',\r\n");
      out.write("\t    dataType:'json',\r\n");
      out.write("\t    success:function(data){ \r\n");
      out.write("\t    \tvar size = data.length;\r\n");
      out.write("\t    \tfor(var i=0;i<size;i++){\r\n");
      out.write("\t\t       $(\"#relateName\").val(data[i].relateName);\r\n");
      out.write("\t\t        $(\"#hiddenTitle\").val(\"[\"+data[i].title+\"]关联商品\");\r\n");
      out.write("\t    \t}\r\n");
      out.write("\t    }, \r\n");
      out.write("\t    async : false,\r\n");
      out.write("\t\tcache : false\r\n");
      out.write("\t});\r\n");
      out.write("}) \r\n");
      out.write("\r\n");
      out.write("function deteleGoodsLink(id){\r\n");
      out.write("\tvar goodsId=\"\";\r\n");
      out.write("\t$(\"input[name='id']\").each(function(i){\r\n");
      out.write("\t   var temp = $(this).val();\r\n");
      out.write("\t   goodsId += (temp+\",\");\r\n");
      out.write("\t });\r\n");
      out.write("\t$.ajax({\r\n");
      out.write("\t\t   dataType:'json',\r\n");
      out.write("\t\t   cache:false,\r\n");
      out.write("\t\t   async:false,\r\n");
      out.write("\t\t   url: \"/sysadm/mall/deteleGoodsLink.do?deteleId=\"+id+\"&ids=\"+goodsId+\"&goodsId=\"+");
      out.write((java.lang.String) org.apache.jasper.runtime.PageContextImpl.proprietaryEvaluate("${param.goodsId}", java.lang.String.class, (javax.servlet.jsp.PageContext)_jspx_page_context, null, false));
      out.write(",\r\n");
      out.write("\t\t   success: function(data){\r\n");
      out.write("\t\t   \t\t$(\"#goodsTable\").empty();\r\n");
      out.write("\t\t        var size = data.length;\r\n");
      out.write("\t\t    \tfor(var i=0;i<size;i++){\r\n");
      out.write("\t\t    \t\tvar goodsItem = \"<li style='float:left;width:130px;border:1px solid #E7E7E7;'><table align='center'><tr><td align='center'><img src='\"+data[i].thumb+\"' width='100px' height='100px'/></td></tr><tr><td align='center'>标题<input type='text' name='relateTitle' value='\"+data[i].relateTitle+\"' style='width: 75px;'/></td></tr><tr><td align='center'>排序<input type='text' value='\"+(i*1+1)+\"' name='orderBy' style='width: 75px;'/></td></tr><tr><td align='center'><a href='javascript:deteleGoodsLink(\"+data[i].itemid+\")'>[移除]</a></td></tr><input type='hidden' value='\"+data[i].itemid+\"' name='id'/></table></li>\";\r\n");
      out.write("\t\t\t       $(\"#goodsTable\").append(goodsItem);\r\n");
      out.write("\t\t    \t}\r\n");
      out.write("\t\t   }\r\n");
      out.write("\t\t});\r\n");
      out.write("}\r\n");
      out.write("\r\n");
      out.write("var api = lhgdialog.focus, //返回当前最顶层窗口实例对象\r\n");
      out.write("\t$$ = function(id){return document.getElementById(id)},\r\n");
      out.write("\tform = $$('formGoodsLink');\r\n");
      out.write("\r\n");
      out.write("var title = $(\"#hiddenTitle\").val();\r\n");
      out.write("\r\n");
      out.write("// 操作对话框\r\n");
      out.write("api.title(title)\r\n");
      out.write("\t// 自定义按钮\r\n");
      out.write("\t.button({\r\n");
      out.write("\t\t\tname: '更新',\r\n");
      out.write("\t\t\tcallback: function(){\r\n");
      out.write("\t\t\tvar relateName = $(\"#relateName\").val();\r\n");
      out.write("\t\t\tvar relateTitle=\"\";\r\n");
      out.write("\t\t\t$(\"input[name='relateTitle']\").each(function(i){\r\n");
      out.write("\t\t\t   var temp = $(this).val();\r\n");
      out.write("\t\t\t   if(temp == \"\"){\r\n");
      out.write("\t\t\t   \t\ttemp = \" \";\r\n");
      out.write("\t\t\t   }\r\n");
      out.write("\t\t\t   relateTitle += (temp+\",\");\r\n");
      out.write("\t\t\t });\r\n");
      out.write("\t\t\tvar goodsId=\"\";\r\n");
      out.write("\t\t\t$(\"input[name='id']\").each(function(i){\r\n");
      out.write("\t\t\t   var temp = $(this).val();\r\n");
      out.write("\t\t\t   goodsId += (temp+\",\");\r\n");
      out.write("\t\t\t });\r\n");
      out.write("\t\t\t$.ajax({\r\n");
      out.write("\t\t\t\t   type: \"POST\",\r\n");
      out.write("\t\t\t\t   cache:false,\r\n");
      out.write("\t\t\t\t   async:false,\r\n");
      out.write("\t\t\t\t   dataType:\"text\",\r\n");
      out.write("\t\t\t\t   url: \"/sysadm/mall/updataGoodsLink.do\",\r\n");
      out.write("\t\t\t\t   data: {\r\n");
      out.write("\t\t\t\t       \"relateName\":relateName,\r\n");
      out.write("\t\t\t\t       \"relateTitle\":relateTitle,\r\n");
      out.write("\t\t\t\t       \"goodsId\":goodsId\r\n");
      out.write("\t\t\t\t   },\r\n");
      out.write("\t\t\t\t   success: function(msg){\r\n");
      out.write("\t\t\t\t   \t\t$.dialog({ \r\n");
      out.write("\t\t\t\t\t\t    time: 1, \r\n");
      out.write("\t\t\t\t\t\t    content: '更新成功！！',\r\n");
      out.write("\t\t\t\t\t\t    max: false, \r\n");
      out.write("   \t\t\t\t\t\t    min: false\r\n");
      out.write("\t\t\t\t\t\t});\r\n");
      out.write("\t\t\t\t        //alert(\"yes\")\r\n");
      out.write("\t\t\t\t   }\r\n");
      out.write("\t\t\t\t});\r\n");
      out.write("\t\t\treturn false;\r\n");
      out.write("\t\t\t}\r\n");
      out.write("\t\t},\r\n");
      out.write("\t\t{\r\n");
      out.write("\t\t\tname: '新增商品',\r\n");
      out.write("\t\t\tcallback: function(){\r\n");
      out.write("\t\t\t\tvar goodsId=\"\";\r\n");
      out.write("\t\t\t\t$(\"input[name='id']\").each(function(i){\r\n");
      out.write("\t\t\t\t   var temp = $(this).val();\r\n");
      out.write("\t\t\t\t   goodsId += (temp+\",\");\r\n");
      out.write("\t\t\t\t });\r\n");
      out.write("\t\t\t\tvar api2 = $.dialog({id:'L1361',width: '550px', height: 350}); \r\n");
      out.write("\t\t\t\t$.ajax({ \r\n");
      out.write("\t\t\t\t    url:'/dialog/goodsList.jsp?goodsId=");
      out.write((java.lang.String) org.apache.jasper.runtime.PageContextImpl.proprietaryEvaluate("${param.goodsId}", java.lang.String.class, (javax.servlet.jsp.PageContext)_jspx_page_context, null, false));
      out.write("&ids='+goodsId,\r\n");
      out.write("\t\t\t\t    dataType:'html',\r\n");
      out.write("\t\t\t\t    success:function(data){ \r\n");
      out.write("\t\t\t\t        api2.content(data); \r\n");
      out.write("\t\t\t\t    }, \r\n");
      out.write("\t\t\t\t    cache:false \r\n");
      out.write("\t\t\t\t});\r\n");
      out.write("\t\t\t\treturn false;\r\n");
      out.write("\t\t\t}\r\n");
      out.write("\t\t}\r\n");
      out.write("\t\t/*, 更多按钮.. */\r\n");
      out.write("\t);\r\n");
      out.write("\t\r\n");
      out.write("\r\n");
      out.write("// 表单验证\r\n");
      out.write("var check = function (input) {\r\n");
      out.write("\tif (input.value === '') {\r\n");
      out.write("\t\tinputError(input);\r\n");
      out.write("\t\tinput.focus();\r\n");
      out.write("\t\treturn false;\r\n");
      out.write("\t} else {\r\n");
      out.write("\t\treturn true;\r\n");
      out.write("\t};\r\n");
      out.write("};\r\n");
      out.write("\r\n");
      out.write("// 输入错误提示\r\n");
      out.write("var inputError = function (input) {\r\n");
      out.write("\tclearTimeout(inputError.timer);\r\n");
      out.write("\tvar num = 0;\r\n");
      out.write("\tvar fn = function () {\r\n");
      out.write("\t\tinputError.timer = setTimeout(function () {\r\n");
      out.write("\t\t\tinput.className = input.className === '' ? 'login-form-error' : '';\r\n");
      out.write("\t\t\tif (num === 5) {\r\n");
      out.write("\t\t\t\tinput.className === '';\r\n");
      out.write("\t\t\t} else {\r\n");
      out.write("\t\t\t\tfn(num ++);\r\n");
      out.write("\t\t\t};\r\n");
      out.write("\t\t}, 150);\r\n");
      out.write("\t};\r\n");
      out.write("\tfn();\r\n");
      out.write("};\r\n");
      out.write("</script>");
    } catch (java.lang.Throwable t) {
      if (!(t instanceof javax.servlet.jsp.SkipPageException)){
        out = _jspx_out;
        if (out != null && out.getBufferSize() != 0)
          try { out.clearBuffer(); } catch (java.io.IOException e) {}
        if (_jspx_page_context != null) _jspx_page_context.handlePageException(t);
        else log(t.getMessage(), t);
      }
    } finally {
      _jspxFactory.releasePageContext(_jspx_page_context);
    }
  }
}
